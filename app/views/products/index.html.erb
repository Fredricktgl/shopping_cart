<div class="container">
  <% if current_user.try(:admin?) %>
  <div class="row admin-console">
    <div class="col-sm-12 d-flex justify-content-center font-weight-light">
      <h4>Welcome back <strong><%= current_user.name %></strong> to the administrative console</h4>
    </div>

    <div class="col-md-6 border-right border-top">
      <h3 class="text-center"><u>Add a new product</u></h3>
      <%= form_for @product, url: products_path do |f| %>
        <h5 class="card-title font-weight-light">Name</h5>
        <%= f.text_field :name, class: "form-control", placeholder: "Product name" %></br>

        <h5 class="card-title font-weight-light">Description</h5>
        <%= f.text_area :description, class: "form-control", rows: "3", placeholder: "Product description" %></br>
        
        <h5 class="card-title font-weight-light">Category</h5>
        <%= f.text_area :description, class: "form-control", rows: "3", placeholder: "Product description" %></br>

        <h5 class="card-title font-weight-light">Price</h5>
        <%= f.text_field :price, class: "form-control", placeholder: "Price in 2 decimals point" %></br>

         <%= f.filestack_field :filepicker_url, "Upload product picture", class: "btn btn-primary" %></br>
        </br>

        <p><%= f.submit "Create product", class: "btn btn-primary" %></p>
      <% end %>
    </div>

    <div class="col-md-6 border-left border-top">
      <h3 class="text-center"><u>Category Management</u></h3>
      <%= form_for @category, url: product_categories_path(@products) do |c| %>
       <h5 class="card-title font-weight-light">Add new Category</h5>
       <table><tr>
          <td width="100%"><%= c.text_field :category, class: "form-control", placeholder: "Product Category" %></td>
          <td><%= c.submit "submit", class: "btn btn-primary" %></td>
        </tr></table>
        </br>
      <% end %>

      <h5 class="card-title font-weight-light text-center">Existing Categories</h5>
      <div class="list-group">
        <% @existing_categories.each do |x| %>
          
            <li class="list-group-item d-flex justify-content-between align-items-center">
              <%= x.category %>
              <div>
              <span class="badge badge-pill badge-primary">Edit</span>
              <span class="badge badge-pill badge-danger">Delete</span>
              </div>
            </li>

        <% end %>
      </div>
    </div>
  </div>
  <% end%>

  <div class="row">
    <div class="col-md-12 testbg">
      rotating banner here </br>
      Hot deals, lobangz </br>
      use carosel from bootstrap
    
    </div>
  </div>

  <div class="row">

    <div class="col-md-12 d-flex justify-content-center">
      <h2>The Marketplace</h2>
    </div>

    <% @products.each do |p| %>
      <div class="col-md-3 d-flex flex-column justify-content-between">
        
        <%= filestack_image p.filepicker_url, transform: filestack_transform.resize(width:250, height:250), class: "card-img-top" %>

        <div>
          <h3 class="card-title product-bg"><%= p.name %></h3>
          <h6 class="card-subtitle mb-2 text-muted"><%= number_to_currency(p.price) %></h6>
          <p class="card-text"><%= p.description %></p>
        </div>
        
        <div>
          <table>
            <tr>
              <% if current_user.try(:admin?) %>
                <td><%= button_to 'Edit', edit_product_path(p), method: :get, class: "btn btn-outline-primary" %></td>
                <td><%= button_to 'Destroy', p, method: :delete, class: "btn btn-danger", data: { confirm: 'This will remove the product, are you sure you want to proceed' } %></td>
              <% end%>
            </tr>
          </table>
        </div>
        
      </div>
    <% end %>
  
  </div>

</div>